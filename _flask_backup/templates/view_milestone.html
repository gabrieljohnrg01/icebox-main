{% extends "base.html" %}
{% block title %}View milestone{% endblock %}
{% block content %}
<div class="main-container-deliverable">
  <form method="POST" enctype="multipart/form-data" class="form-deliverable-container">
    <div class="container-md" id="step-icon-opncls">
      <div class="progress-tracker-vertical">
        <div class="progress-line-vertical"></div>
        {% for i in range(1, 6) %}
          {% if deliverableStatus.get(i) == 'Completed' %}
            <div class="step" data-value="{{ i }}">
              <div class="step-icon completed" >
                <i class="bi bi-check-circle-fill"></i>
              </div>
              <input type="hidden" name="deliverable_name" value="" id="deliverableInput">
            </div>
          {% elif deliverableStatus.get(i) == 'Pending' %}
            <div class="step-view" data-value="{{ i }}">
              <div class="step-icon in-progress" >
                <i class="bi bi-hourglass-split"></i>
              </div>
              <input type="hidden" name="deliverable_name" value="" id="deliverableInput">
            </div>
          {% else%}
            <div class="step" data-value="{{ i }}">
              <div class="step-icon not-yet" >
                <i class="bi bi-x-circle-fill"></i>
              </div>
              <input type="hidden" name="deliverable_name" value="" id="deliverableInput">
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
    <!-- Edit deliverable -->
    <div class="edit-deliverable hide" id="Edit-Dcontainer">
      <div class="card-deliverable">
        <h3>Edit Deliverable</h3>
        <div class="close-btn">
          <i class="bi bi-x-circle" id="closebtn"></i>
        </div>
        <!-- Start one form here -->
        <div class = "deliverable-form">
          <!-- Container 1: File attachments -->
          <div class="container-deliverable">
            <div class="mb-3">
              <label for="formFile" class="form-label">Upload File</label>
              <input class="form-control" type="file" id="formFile" name="upload-file">
            </div>
            <div class="mb-3">
              <a href="{{ url_for('download_attachfile') }}" class="btn btn-success">Download Temp File</a>
            </div>
          </div>
          <!-- Container 2: Readiness level and Date -->
          <div class="container-deliverable">
            <div id="checked-container">
              {% for option in ['TRL', 'BRL', 'CRL', 'MRL'] %}
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="{{ option }}" id="checkDefault" name="options">
                <label class="form-check-label" for="checkDefault"> {{ option }} </label>
              </div>
              {% endfor %}
            </div>
            <div class="card-date">
              <label for="dueDate">Due Date:</label>
              <input type="date" id="dueDate" name="due_date" />
            </div>
          </div>

          <!-- Container 3: Comments and Requirements -->
          <div class="container-deliverable">
            <div class="comment">
              <label for="comments">Comments:</label>
              <textarea id="comments" name="comments" rows="4" cols="50"></textarea>
            </div>
            <div class="requirements">
              <label for="requirements">Requirements:</label>
              <textarea id="requirements" name="requirements" rows="4" cols="50"></textarea>
            </div>
          </div>

          <!-- Submit button for everything -->
          <br>
          <button type="submit">Save Deliverable</button>
        </div>
        <!-- End of single form -->
      </div>
    </div>

    <!-- view deliverable -->
    <div class="view-deliverable-container hide" id="view-deliverable-container">
      <div class="view-box">
        <h3>View Deliverables</h1>
        <div class="close-view-btn">
          <i class="bi bi-x-circle" id="closebtn"></i>
        </div>
        <div class="deliverable">
          <div class="mb-3 de-margin">
            <label for="formFile" class="form-label">Upload File</label>
            <input class="form-control" type="file" id="formFile" name="upload-file">
          </div>
          <a href="{{ url_for('download_attachfile') }}" class="btn btn-success de-margin">Download attach File</a>
          <div class="container-deliverable de-margin">
            <div id="level-select">
              {% for r in readiness_name %}
                <label for="{{ r }}">{{ r }}</label>
                <select class="form-select" aria-label="Default select example" id="level" name="{{ r }}">
                  <option selected disabled>Select Readiness Level</option>
                  {% for i in range(1, 10) %}
                  <option value="{{ i }}">Level {{ i }}</option>
                  {% endfor %}
                </select>
              {% endfor %}
            </div>
          </div>
          <div class="container-deliverable de-margin">
            <div class="comment">
              {% for c in comment_context %}
              <div class="comment-context">
                <label for="comments">Recent comments:</label>
                <label for="user">{{ user_name }}</label>
                <textarea id="comments" name="comments" rows="4" cols="50" disabled>{{ c }}</textarea>
              </div>
              {% endfor %}
              <div class="comment-upload">
                <label for="formFile" class="form-label">Comment:</label>
                <textarea id="comments" name="comments" rows="4" cols="50"></textarea>
              </div>
            </div>
            {% for req in requirements_list %}
            <div class="requirements">
              <label for="requirements">Requirements:</label>
              <textarea id="requirements" name="requirements" rows="4" cols="50" disabled>{{ req }}</textarea>
            </div>
            {% endfor %}
          </div>
        </div>
        <button type="submit">Save Deliverable</button>
      </div>
    </div>
  </form>
</div>
{% endblock %}
